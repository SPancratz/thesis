% Chapter:  Introduction to the deformation method  %%%%%%%%%%%%%%%%%%%%%%%%%%%

% Definitions and notation %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Definitions and notation}

In this section we present the problem that we are concerned 
with in this part of the thesis and carefully set up the notation 
that we are using throughout.  We begin by giving a brief overview.

The aim of the deformation method as introduced by 
Lauder~\citep{Lau04} following a paper by Dwork~\citep{Dwork62b} 
is to compute the zeta function of a smooth 
hypersurface, which in hindsight we call $X_{t_1}$, in projective 
$n$-space over a finite field of characteristic~$p$.  This is 
facilitated by computing 
the action of the Frobenius morphism on the associated rigid cohomology 
spaces $H_{rig}^{\bullet}(X_{t_1})$.  The main idea is to embed this 
hypersurface in a family of smooth projective hypersurfaces~$X/S$ 
defined over a finite field~$k$, where $S \subset A_k^1(t)$, containing 
a fibre~$X_{t_0}$ for which it is easier to compute the Frobenius action. 
Lifting the family~$X/S$ to a family $\mathfrak{X}/\mathfrak{S}$ in 
characteristic zero, we can utilise a certain $p$-adic differential 
equation involving the Frobenius matrix and the algebraic Gauss--Manin 
connection.  Moreover, due to a comparison theorem of Baldassarri and 
Chiarellotto~\citep{BalChi94}, in this 
part of the algorithm we can work with the algebraic de~Rham cohomology 
spaces~$H_{dR}^{\bullet}(\mathfrak{X}/\mathfrak{S})$, which are 
computationally more accessible.  Solving this differential equation 
and using the Frobenius action on~$\mathfrak{X}_{t_0}$ as the initial 
condition, by an appropriate evaluation we can compute the Frobenius matrix 
for~$X_{t_1}$ and hence recover its zeta function.

For the remaining part of this thesis, we restrict ourselves to the case 
where the family $\mathfrak{X}/\mathfrak{S}$ is defined over a prime field, 
$t_0 = 0$, and the initial fibre $X_0$ is diagonal.  Specifically, we 
establish our set-up closely following Tuitman~\citep[\S 3.6]{Tuitman2011} 
and using the same choice of resultant as Lauder~\citep[\S 2.3.2]{Lauder2011}.

\begin{notation} \label{not:01-03-main}
Let $\mathbf{F}_q$ be the finite field with $q = p^a$ elements, 
let $\mathbf{Q}_q$ denote the unique unramified extension of $\mathbf{Q}_p$ 
with residue field $\mathbf{F}_q$, and let $\mathbf{Z}_q$ denote its 
ring of integers.

We let $P \in \mathbf{Z}[t][x_0,\dotsc,x_n]$ be a homogenous polynomial 
of degree~$d$ with $n, d \geq 1$.  We define $r(t) \in \mathbf{Q}[t]$ as 
the \emph{Macaulay resultant} of the partial derivatives of~$P$ as 
in~\citep[Page~7, Chapter~I.6]{Macaulay1994}.  We can now define two 
smooth $\mathbf{Z}_q$-schemes $\mathfrak{X}$ and $\mathfrak{S}$ as 
\begin{align*}
\mathfrak{X} & = \Spec\bigl( \mathbf{Z}_q[t,r(t)^{-1}][x_0,\dotsc,x_n] / (P)\bigr), \\
\mathfrak{S} & = \Spec\bigl( \mathbf{Z}_q[t,r(t)^{-1}] \bigr)
\end{align*}
together with the obvious smooth projective morphism 
$\mathfrak{X} \to \mathfrak{S}$.  We also define the generic fibres 
$\mathbf{X}$ and $\mathbf{S}$ of $\mathfrak{X}$ and $\mathfrak{S}$ as 
\begin{align*}
\mathbf{X} & = \Spec\bigl( \mathbf{Q}_q[t,r(t)^{-1}][x_0,\dotsc,x_n] / (P)\bigr), \\
\mathbf{S} & = \Spec\bigl( \mathbf{Q}_q[t,r(t)^{-1}] \bigr),
\end{align*}
respectively.  Moreover, we let $X$ and $S$ denote the projections 
of $\mathfrak{X}$ and $\mathfrak{S}$ to characteristic~$p$. 
Finally, we define complements $\mathfrak{U}$, $\mathbf{U}$, and $U$ 
of $\mathfrak{X}$, $\mathbf{X}$, and $X$, respectively, in the 
ambient projective $n$-space.

We assume that $r(0) \neq 0$ and hence that $\mathfrak{X}_0$ is a 
smooth, projective hypersurface, which we will moreover assume to be 
diagonal, and that $t_1 \in S$ is a non-zero point.
\end{notation}

\begin{notation}
Furthermore, as an artefact of our particular choice of basis for 
$H_{dR}^n(\mathfrak{U}/\mathfrak{S})$ in Definition~\ref{defn:01-05-basis}, 
we assume that $d \geq 2$ whenever $n$ is odd and $d \geq 3$ whenever $n$ 
is even.
\end{notation}

\begin{rem}
By considering the diagonal fibre~$X_0$, which is a non-singular variety 
over $\mathbf{F}_p$, we see that our assumptions imply $p \nmid d$.
\end{rem}

% Outline of the algorithm %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Outline of the algorithm}

The deformation algorithm is outlined in Figure~\ref{fig:01-03-deformation}.

\begin{figure}[h]
\centering
\begin{tikzpicture}[node distance = 24mm, auto]

    % Define block styles
    \tikzstyle{block} = [rectangle, draw, 
        text centered, rounded corners, minimum height = 6mm]
    \tikzstyle{empty} = [rectangle]
    \tikzstyle{line} = [draw, -latex']

    % Place nodes
    \node [block, text width = 100mm] (input) 
        {Polynomial $P \in \mathbf{Z}[t][x_0, \dotsc, x_n]$; 
        point $t_1 \in \mathbf{F}_q$ with $q = p^a$};

    \node [block, below left=14.6mm and -30mm of input, text width = 48mm] (diag) 
        {Matrix $\Phi_0$ over $\mathbf{Q}_p \bmod p^{N_4}$ for $p^{-1} F_p$ 
        on $H_{dR}^n(\mathfrak{U}_0)$};

    \node [block, below right=6mm and -50mm of input, text width = 58mm] (gm) 
        {Connection matrix $M$ over $\mathbf{Q}(t)$ 
        with denominator $r \in \mathbf{Z}[t]$};

    \node [block, below=6mm of gm, text width = 82mm] (local) 
        {Solution $C(t)$ in $\mathbf{Q}_p[[t]] \bmod {\bigl(p^{N_3}, t^{K}\bigr)}$ of the 
        differential equation \mbox{$\bigl(\tfrac{d}{dt} + M\bigr) C = 0$}, 
        and $C(t^p)^{-1}$};

    \node [block, below=42mm of input, text width = 130mm] (series)
        {Matrix $\Phi(t) = C(t) \Phi_0 C(t^p)^{-1}$ in 
        $\mathbf{Q}_p[[t]] \bmod {\bigl(p^{N_2}, t^{K}\bigr)}$ for $p^{-1} F_p$ 
        on $H_{dR}^n(\mathfrak{U}_t)$};

    \node [block, below=6mm of series, text width = 78mm] (poly) 
        {Matrix $r(t)^m \Phi(t)$ over $\mathbf{Q}_p[t] \bmod {p^{N_2}}$};

    \node [block, below=6mm of poly, text width = 74mm] (eval) 
        {Matrix $\Phi_1 = r(\hat{t}_1)^{-m} \bigl(r(t)^m \Phi(t)\bigr) \big\vert_{t={\hat{t}_1}}$ over 
        $\mathbf{Q}_q \bmod p^{N_2}$ for $p^{-1} F_p$ on 
        $H_{dR}^n(\mathfrak{U}_{t_1})$}; 

    \node [block, below=6mm of eval, text width = 120mm] (qpower) 
        {Matrix $\Phi_{q,1} = \Phi_1 \Phi_1^{\sigma} \dotsm \Phi_1^{\sigma^{a-1}}$ 
        over $\mathbf{Q}_q \bmod {p^{N_1}}$ for $q^{-1} F_q$ on $H_{dR}^n(\mathfrak{U}_{t_1})$};

    \node [block, below=6mm of qpower, text width = 92mm] (zeta) 
        {Polynomial $p(T) = \det\bigl(1 - T q^{-1} F_q | H_{dR}^n(\mathfrak{U}_{t_1})\bigr)$ over $\mathbf{Z}$}; 

    % Draw edges
    \path [line] (input) -- (diag);
    \path [line] (input) -- (gm);
    \path [line] (gm) -- (local);
    \path [line] (diag) -- (series);
    \path [line] (local) -- (series);
    \path [line] (series) -- (poly);
    \path [line] (poly) -- (eval);
    \path [line] (eval) -- (qpower);
    \path [line] (qpower) -- (zeta);

\end{tikzpicture}
\caption{Flowchart describing the deformation algorithm}
\label{fig:01-03-deformation}
\end{figure}
